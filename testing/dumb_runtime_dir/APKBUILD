# Contributor: Marten Ringwelski <git+alpine@maringuu.de>
# Maintainer: Marten Ringwelski <git+alpine@maringuu.de>
pkgname=dumb_runtime_dir
pkgver=1.0.4
pkgrel=4
pkgdesc="Creates an XDG_RUNTIME_DIR on login and never removes it"
url="https://github.com/ifreund/dumb_runtime_dir"
arch="all"
license="0BSD"
makedepends="linux-pam-dev"
source="https://github.com/ifreund/dumb_runtime_dir/archive/v$pkgver/dumb_runtime_dir-v$pkgver.tar.gz"
options="!check" # no test suite

build() {
	# Create XDG_RUNTIME_DIRs directly in /run, the default is /run/user/,
	# which would mean the user has to create it manualy with the right
	# permissions.
	#
	# Without this change, dumb_runtime_dir does not work out-of-the-box.
	# In the future OpenRC may create /run/user from bootmisc [1]. Or, we
	# could patch the code to create the directory as /run/user-$UID.
	#
	# [1]: https://github.com/OpenRC/openrc/issues/658
	make RUNTIME_DIR_PARENT=/run
}

package() {
	make DESTDIR="$pkgdir" install
}

sha512sums="
f7607a1e048efa686e8f266efc9b798c905840fe660a8d3d4ead538b258971a1787406e94c792883e886360672ebc1d9fb812b2bf54755f1135a15479514d962  dumb_runtime_dir-v1.0.4.tar.gz
"
