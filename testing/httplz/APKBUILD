# Contributor: Patrycja Rosa <alpine@ptrcnull.me>
# Maintainer: Patrycja Rosa <alpine@ptrcnull.me>
pkgname=httplz
pkgver=2.2.0
pkgrel=0
pkgdesc="Basic http server for hosting a folder fast and simply"
url="https://github.com/thecoshman/http"
arch="all"
license="MIT"
makedepends="cargo cargo-auditable openssl-dev linux-headers"
subpackages="$pkgname-doc"
source="https://github.com/thecoshman/http/archive/v$pkgver/httplz-$pkgver.tar.gz
	Cargo.lock
	"
builddir="$srcdir/http-$pkgver"
options="net" # cargo crates

prepare() {
	default_prepare
	mv "$srcdir"/Cargo.lock .

	cargo fetch --target="$CTARGET" --locked
}

build() {
	cargo auditable build --frozen --release
}

check() {
	cargo test --frozen
}

package() {
	install -Dm755 target/release/httplz -t "$pkgdir"/usr/bin/
	install -Dm644 LICENSE -t "$pkgdir"/usr/share/licenses/$pkgname/
}

sha512sums="
8d41b3216b44b3f01e247a381f97c5879a283934a448338cb82835822c31be97591de7ffb1a1f6a0fb3bdd60de70f57c5e48cc56f71bc71e1f74b85c318b6a51  httplz-2.2.0.tar.gz
da766208907a7ae7b271f5bd046b79d72b55b67ac391b3302330a7cb9310389cc504b5e876b1e6e6b44c841d7b398009d8f09bb667b679829011e35589a273ef  Cargo.lock
"
