# Contributor: Patrycja Rosa <alpine@ptrcnull.me>
# Maintainer: Patrycja Rosa <alpine@ptrcnull.me>
# version must be kept in sync with libqalculate
pkgname=qalculate-qt
pkgver=5.7.0
pkgrel=0
pkgdesc="Multi-purpose desktop calculator - Qt version"
url="https://github.com/Qalculate/qalculate-qt"
# qmake is broken on riscv64
arch="all !riscv64"
license="GPL-2.0-or-later"
depends="gnuplot"
makedepends="qt6-qtbase-dev qt6-qttools-dev libqalculate-dev"
subpackages="$pkgname-doc"
source="https://github.com/Qalculate/qalculate-qt/releases/download/v$pkgver/qalculate-qt-$pkgver.tar.gz"
options="!check" # no test suite

build() {
	export CFLAGS="$CFLAGS -flto=auto"
	export CXXFLAGS="$CXXFLAGS -flto=auto"
	qmake6 PREFIX=/usr
	make
}

check() {
	make check
}

package() {
	make INSTALL_ROOT="$pkgdir" install
}

sha512sums="
6f55642ad8aeec7cdff52a92ad96aa22a3f76be612e468857fe5ff546f3431e7917fffcdbd5bc61bc82e68d2edb0dbc1451136ce0d07ac8f9f4995e0ea318a4f  qalculate-qt-5.7.0.tar.gz
"
