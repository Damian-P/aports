# Contributor: Milan P. Stanić <mps@arvanta.net>
# Maintainer: Milan P. Stanić <mps@arvanta.net>
pkgname=m1n1
pkgver=1.5.0
pkgrel=1
pkgdesc="bootloader and experimentation playground for Apple Silicon"
url="https://github.com/AsahiLinux/m1n1"
arch="aarch64"
license="MIT"
options="!check" # no tests
makedepends="llvm bash imagemagick dtc"

# files alpine_128.png and alpine_256.png created by convert image from
# https://gitlab.alpinelinux.org/alpine/infra/alpine-mksite/-/blob/master/_static/alpinelinux-logo-icon.svg
# for needed format and sizes
source="m1n1-$pkgver.tar.gz::https://github.com/AsahiLinux/m1n1/archive/refs/tags/v$pkgver.tar.gz
	alpine_128.png
	alpine_256.png
	"

build() {
	cp -f "$srcdir"/alpine_128.png data/
	cp -f "$srcdir"/alpine_256.png data/
	make LOGO=alpine ARCH=
}

package() {
	mkdir -p "$pkgdir"/usr/share/m1n1
	install -p -Dm644 "$builddir"/build/m1n1.bin $pkgdir/usr/share/m1n1/
	install -p -Dm644 "$builddir"/build/m1n1.macho $pkgdir/usr/share/m1n1/
}

sha512sums="
27fd6852c8046f59fd742bbeb99fbf4da28df9f2b70ca6ddcc75741e0c40df8e0a112444f1d18e8d47ca9896e55a9c463a1a4daa730e9914f6101445f77f0c6a  m1n1-1.5.0.tar.gz
5aef6a2343fd22fc02ab0d1031adc82e39ee4e9a58516ef562eadea4a10b155fca5fdc72433ac1627d09f19cacb0a9eeaa08a54b18841616e6a05bbf1ccbc973  alpine_128.png
f29728e685678e1a946bb371b04dbcad56b69e94f144a003be1e9e0024fdef714ff02a7d822c93ad8d62cf3000a7afab4c304fe541019ca44d7984c6817479cb  alpine_256.png
"
